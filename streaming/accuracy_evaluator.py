import pandas as pd

TEST_PATH = "D:/IntelliJ_Workspace/fairER/data/er_magellan/Structured/Beer/test.txt"
# goldstandard = pd.read_csv(TEST_PATH, header=None, sep='\n')

# clusters = [[' microsoft outlook 2007 ', ' microsoft office outlook 2007 '], [' icopydvds2 ultra by digital wunders ', ' global marketing partners icopydvds2 ultra by digital wunders '], [' microsoft onenote 2007 ', ' microsoft onenote 2007 ( pc ) '], [' rome total war gold edition ', ' sega of america inc rome total war gold edition '], [' microsoft windows server 2003 client additional license for devices 5 pack ', ' microsoft windows server 2003 client additional license for devices 5 pack ( 823930 ) '], [' sony sound forge audio studio 8 ', ' sony media software sound forge audio studio 8 software music production software '], [' microsoft windows vista business full version [ dvd ] ', ' microsoft windows vista business retail no open box returns '], [' upg sgms 1000 incremental node ', ' sonicwall gms 1000n-incremental lic upg '], [' microsoft office 2004 professional ( mac ) ', ' microsoft microsoft office pro 2004 software suite mac apple & mac software '], [' learn2 training for microsoft powerpoint ', ' learn2 training for microsoft powerpoint ( win 95 98 me nt 2000 xp ) '], [' microsoft office 2004 standard upgrade ( mac ) ', ' microsoft office 2004 std upgrade '], [' hoyle mahjongg ( jewel case ) ', ' encore software 10023 hoyle mahjongg ( win 98 me 2000 xp ) '], [' microsoft windows vista ultimate upgrade [ dvd ] ', ' windows vista ultimate upgrade '], [' 123 movies 2 ipod w / av cables umd size ', ' bling software limited 05013 123 movies 2 ipod w / av cables umd size '], [' microsoft word 2004 upgrade ( mac ) ', ' word mac 2004 upgrade microsoft d48-00488 '], [' sony psp media manager ', ' sony media manager for psp ( 98598 ) '], [' microsoft windows vista home basic upgrade [ dvd ] ', ' microsoft windows vista home basic upgrade ( pc ) '], [' sony super duper music looper ', ' sony media software super duper music looper software music production software '], [' microsoft windows small business server cal 2003 license pack 20 client addpack device ', ' t74-00004 microsoft windows small business server 2003 license 20 additional user cals '], [' xtreme photostory on cd and dvd 6 ', ' magix entertainment corp. xtreme photostory on cd and dvd 6 ']]
clusters = [[' Red Rocket Amber Ale ', ' Third Base Red Rocket Amber Ale '], [' Thomas Hooker Old Marley Barleywine ', ' Thomas Hooker Old Marley Barleywine '], [' Bushfire American Red ', ' Granite Falls Bushfire American Red Ale '], [' Arrow Point Amber ', ' Bainbridge Island Arrow Point Amber '], [' Heatwave Red Ale ', ' La Quinta Brewing Co. . Heatwave Red Ale '], [' Real McCoy Amber Ale ', ' Mammoth Real McCoy Amber Ale '], [' Red Ale Priprioca ', ' Amazon Beer Priprioca Red Ale '], [' Amber Waves Ale ', ' Capitol City Amber Waves Ale '], [' Sanibel Red Island Ale ', ' Baranof Island Redoubt Red Ale '], [' Centurion Barleywine Ale ', ' Golden City Centurion Barleywine Ale '], [' Rock Bottom Red Ale ', ' Rock Bottom La Jolla Ragtop Red Ale '], [' Lower De Boom Barleywine ', ' 21st Amendment Bourbon Barrel Lower da Boom Barleywine '], [' Honey Basil Amber ', ' Rude Hippo Honey Basil Amber '], [' Green Lakes Organic Ale ', ' Deschutes Green Lakes Non-Organic Ale '], [' Willoughby American Amber Ale ', ' Willoughby American Amber Ale '], [" Legends Of The Bay Giant 's Tomb ", ' Legends of the Bay Giant_s Tomb '], [' Pike Old Bawdy Barley Wine ', ' Bristol Old No. 23 Barley Wine '], [' Jazz Beer Tarraco Amber ', ' Jazz Beer Tarraco Amber '], [' Sierra Amber Ale ', ' Sierra Andina Alpamayo Amber Ale '], [' Easy Amber Ale ', ' Upland Easy Chair Amber Ale ']]
# clusters = [[' characterization of database access pattern for analytic prediction of buffer hit probability ', ' characterization of database access pattern for analytic prediction of buffer hit probability '], [' a multi-agent system infrastructure for software component market-place : an ontological perspective ', ' a multi-agent system infrastructure for software component market-place : an ontological perspective '], [' cost models do matter : providing cost information for diverse data sources in a federated system ', ' cost models do matter : providing cost information for diverse data sources in a federated system '], [' intra-transaction parallelism in the mapping of an object model to a relational multi-processor system ', ' intra-transaction parallelism in the mapping of an object model to a relational multi-processor system '], [' the multiview project : object-oriented view technology and applications ', ' the multiview project : object-oriented view technology and applications '], [' dbglobe : a service-oriented p2p system for global computing ', ' dbglobe : a service-oriented p2p system for global computing '], [' a query language for a web-site management system ', ' a query language for a web-site management system '], [' enabling end-users to construct data-intensive web-sites from xml repositories : an example-based approach ', ' enabling end-users to construct data-intensive web-sites from xml repositories : an example-based approach '], [' performance of data-parallel spatial operations ', ' performance of data-parallel spatial operations '], [' mariposa : a wide-area distributed database system ', ' mariposa : a wide-area distributed database system '], [' memory-contention responsive hash joins ', ' memory-contention responsive hash joins '], [' the sdss skyserver : public access to the sloan digital sky server data ', ' the sdss skyserver : public access to the sloan digital sky server data '], [' the strip rule system for efficiently maintaining derived data ', ' the strip rule system for efficiently maintaining derived data '], [' the medusa project : autonomous data management in a shared-nothing parallel database machine ', ' the medusa project : autonomous data management in a shared-nothing parallel database machine '], [' a monte carlo algorithm for fast projective clustering ', ' a monte carlo algorithm for fast projective clustering '], [' databases and workflow management : what is it all about ? ( panel ) ', ' databases and workflow management : what is it all about ? ( panel ) '], [' the clio project : managing heterogeneity ', ' the clio project : managing heterogeneity '], [' data-driven , one-to-one web site generation for data-intensive applications ', ' data-driven , one-to-one web site generation for data-intensive applications '], [' explaining differences in multidimensional aggregates ', ' explaining differences in multidimensional aggregates '], [' exact : an extensible approach to active object-oriented databases ', ' exact : an extensible approach to active object-oriented databases ']]
# clusters = [(' proxy-based acceleration of dynamically generated content on the world wide web : an approach and implementation ', ' proxy-based acceleration of dynamically generated content on the world wide web : an approach and implementation ', 0.9999774597473271, True), (' an ebxml infrastructure implementation through uddi registries and rosettanet pips ', ' an ebxml infrastructure implementation through uddi registries and rosettanet pips ', 0.9999815541446431, False), (' ariadne : a system for constructing mediators for internet sources ', ' ariadne : a system for constructing mediators for internet sources ', 0.999975566131382, True), (' the piazza peer data management project ', ' the piazza peer data management project ', 0.9999794916943441, False), (' navigating large-scale semi-structured data in business portals ', ' navigating large-scale semi-structured data in business portals ', 0.999973195682967, True), (' a performance study of workfile disk management for concurrent mergesorts in a multiprocessor database system ', ' a performance study of workfile disk management for concurrent mergesorts in a multiprocessor database system ', 0.999974902462847, False), (' on the computation of multidimensional aggregates ', ' on the computation of multidimensional aggregates ', 0.9999697385681271, True), (' peerdb : peering into personal databases ', ' peerdb : peering into personal databases ', 0.9999741272153071, False), (' characterization of database access pattern for analytic prediction of buffer hit probability ', ' characterization of database access pattern for analytic prediction of buffer hit probability ', 0.999969469076144, True), (' metrics for accessing heterogeneous data : is there any hope ? ( panel ) ', ' metrics for accessing heterogeneous data : is there any hope ? ( panel ) ', 0.9999736292342811, False), (' on-line reorganization of sparsely-populated b + trees ', ' on-line reorganization of sparsely-populated b + - trees ', 0.999968821497425, True), (' infoharness : a system for search and retrieval of heterogeneous information ', ' infoharness : a system for search and retrieval of heterogeneous information ', 0.9999726851525541, False), (' bulk loading into an oodb : a performance study ', ' bulk loading into an oodb : a performance study ', 0.9999683247540071, True), (' social , educational , and governmental change enabled through information technology ', ' social , educational , and governmental change enabled through information technology ', 0.9999725120987881, False), (' topaz : a cost-based , rule-driven , multi-phase parallelizer ', ' topaz : a cost-based , rule-driven , multi-phase parallelizer ', 0.99996708563614, True), (' intra-transaction parallelism in the mapping of an object model to a relational multi-processor system ', ' intra-transaction parallelism in the mapping of an object model to a relational multi-processor system ', 0.9999722144800051, False), (' a brief survey of web data extraction tools ', ' a brief survey of web data extraction tools ', 0.9999670788398171, True), (' java support for data-intensive systems : experiences building the telegraph dataflow system ', ' java support for data-intensive systems : experiences building the telegraph dataflow system ', 0.999972056344498, False), (' hierarchical subspace sampling : a unified framework for high dimensional data reduction , selectivity estimation and nearest neighbor search ', ' hierarchical subspace sampling : a unified framework for high dimensional data reduction , selectivity estimation and nearest neighbor search ', 0.999965947655803, True), (" report in isdo ' 00 : the caise * 00 workshop on infrastructures for dynamic business-to-business service outsourcinga ", " report on isdo ' 00 : the caise * 00 workshop on infrastructures for dynamic business-to-business service outsourcing ", 0.9999705788776391, False)]
# clusters = [(' microsoft outlook 2007 ', ' microsoft office outlook 2007 ', 0.989800775263963, True), (' sony sound forge audio studio 8 ', ' sony media software sound forge audio studio 8 software music production software ', 0.996925317916391, False), (' microsoft onenote 2007 ', ' microsoft onenote 2007 ( pc ) ', 0.9827339885452201, True), (' rome total war gold edition ', ' sega of america inc rome total war gold edition ', 0.996823620281692, False), (' microsoft windows server 2003 client additional license for devices 5 pack ', ' microsoft windows server 2003 client additional license for devices 5 pack ( 823930 ) ', 0.9326520594529121, True), (' icopydvds2 ultra by digital wunders ', ' global marketing partners icopydvds2 ultra by digital wunders ', 0.9967938468453491, False), (' microsoft windows vista business full version [ dvd ] ', ' microsoft windows vista business retail no open box returns ', 0.924616516561896, True), (' upg sgms 1000 incremental node ', ' sonicwall gms 1000n-incremental lic upg ', 0.9966511573213751, False), (' microsoft office 2004 professional ( mac ) ', ' microsoft microsoft office pro 2004 software suite mac apple & mac software ', 0.886904670581486, True), (' hoyle mahjongg ( jewel case ) ', ' encore software 10023 hoyle mahjongg ( win 98 me 2000 xp ) ', 0.9960691863664641, False), (' microsoft office 2004 standard upgrade ( mac ) ', ' microsoft office 2004 std upgrade ', 0.7461727431528591, True), (' 123 movies 2 ipod w / av cables umd size ', ' bling software limited 05013 123 movies 2 ipod w / av cables umd size ', 0.996043829940722, False), (' microsoft windows vista ultimate upgrade [ dvd ] ', ' windows vista ultimate upgrade ', 0.605573846948405, True), (' learn2 training for microsoft powerpoint ', ' learn2 training for microsoft powerpoint ( win 95 98 me nt 2000 xp ) ', 0.9960016175192951, False), (' microsoft word 2004 upgrade ( mac ) ', ' word mac 2004 upgrade microsoft d48-00488 ', 0.584069951173239, True), (' webroot spysweeper antispyware 3 user ', ' webroot software 65210 spy sweeper 3 pc ', 0.9958281364511901, False), (' microsoft windows vista home basic upgrade [ dvd ] ', ' microsoft windows vista home basic upgrade ( pc ) ', 0.5366733495765721, True), (' sims 2 glamour life stuff pack ', ' aspyr media inc sims 2 glamour life stuff pack ', 0.9956390601336821, False), (' microsoft windows small business server cal 2003 license pack 20 client addpack device ', ' t74-00004 microsoft windows small business server 2003 license 20 additional user cals ', 0.47844862432225105, True), (' sony psp media manager ', ' sony media manager for psp ( 98598 ) ', 0.9955659011744431, False)]
# clusters = [(' Red Rocket Amber Ale ', ' Third Base Red Rocket Amber Ale ', 0.991677789750364, True), (' Thomas Hooker Old Marley Barleywine ', ' Thomas Hooker Old Marley Barleywine ', 0.9918679541706821, False), (' Bushfire American Red ', ' Granite Falls Bushfire American Red Ale ', 0.9916308602819831, True), (' Arrow Point Amber ', ' Bainbridge Island Arrow Point Amber ', 0.991861234155301, False), (' Heatwave Red Ale ', ' La Quinta Brewing Co. . Heatwave Red Ale ', 0.9910966427728751, True), (' Amber Waves Ale ', ' Capitol City Amber Waves Ale ', 0.9918111635909771, False), (' Red Ale Priprioca ', ' Amazon Beer Priprioca Red Ale ', 0.987180074194777, True), (' Real McCoy Amber Ale ', ' Mammoth Real McCoy Amber Ale ', 0.9918054531598991, False), (' Sanibel Red Island Ale ', ' Baranof Island Redoubt Red Ale ', 0.932080955128283, True), (' Green Lakes Organic Ale ', ' Deschutes Green Lakes Non-Organic Ale ', 0.9917281918155451, False), (' Rock Bottom Red Ale ', ' Rock Bottom La Jolla Ragtop Red Ale ', 0.8027423447679071, True), (' Centurion Barleywine Ale ', ' Golden City Centurion Barleywine Ale ', 0.9916853893336681, False), (' Lower De Boom Barleywine ', ' 21st Amendment Bourbon Barrel Lower da Boom Barleywine ', 0.9916159577326881, False), (' Honey Basil Amber ', ' Rude Hippo Honey Basil Amber ', 0.9915809311181281, False), (' Willoughby American Amber Ale ', ' Willoughby American Amber Ale ', 0.9914524755355851, False), (' Pike Old Bawdy Barley Wine ', ' Bristol Old No. 23 Barley Wine ', 0.9865129231335791, False), (' Jazz Beer Tarraco Amber ', ' Jazz Beer Tarraco Amber ', 0.9610933129626971, False), (' Easy Amber Ale ', ' Upland Easy Chair Amber Ale ', 0.579523535678347, False), (' Sierra Amber Ale ', ' Sierra Andina Alpamayo Amber Ale ', 0.510330145629672, False), (' Ambleside Amber Ale ', ' Bridge Ambleside Amber Ale - Pomegranate & Galena Hops ', 0.462755523505041, False)]


print(len(clusters))
with open(TEST_PATH) as file:
    goldstandard = [line.rstrip() for line in file]

correct = 0
wrong = 0
for pair in clusters:
    for result in goldstandard:
        if(pair[0] in result.split('\t')[0] and pair[1] in result.split('\t')[1]):
            if(result[len(result)-1] == '1'):
                correct+=1
            else:
                wrong+=1
            print(result)

print("Correct: " + str(correct))
print("Wrong: " + str(wrong))
print("Accuracy: " + str(correct/(correct + wrong)))
file.close()
